function InfinityScroll(t,i){t&&(this.isCatched=!1,this.config=Object.assign(new InfinityScroll.Config,i||{}),this._elm=this._catchElm(t),this._map=new InfinityScroll.Map(this._elm,this.config),this._overlay=new InfinityScroll.Overlay(this),this._inertionState=new InfinityScroll.InertionState(this),this._catchFn=this._catchUnbindedFn(),this._uncatch=this._uncatchUnbindedFn(),this._move=this._moveUnbindedFn(),this._tempMousePosX=void 0,this._tempMousePosY=void 0,this.initListeners())}InfinityScroll.prototype._moveUnbindedFn=function(){var i=this;return function(t){i.isCatched&&(i.config.inertia&&i._inertionState.updateStartPos(t),"mousemove"===t.type&&(i.moveTo(t.clientX-i._tempMousePosX,t.clientY-i._tempMousePosY),i._tempMousePosX=t.clientX,i._tempMousePosY=t.clientY),"touchmove"===t.type&&(i.moveTo(t.touches[0].clientX-i._tempMousePosX,t.touches[0].clientY-i._tempMousePosY),i._tempMousePosX=t.touches[0].clientX,i._tempMousePosY=t.touches[0].clientY))}},InfinityScroll.prototype._uncatchUnbindedFn=function(){var i=this;return function(t){i.isCatched=!1,i._tempMousePosX=void 0,i._tempMousePosY=void 0,i.config.inertia&&(i._inertionState.updateImpulses(t),i._inertionState.inertionMove())}},InfinityScroll.prototype.initListeners=function(){this._addMouseListeners()},InfinityScroll.prototype.moveTo=function(t,i){this.config.axisX&&this._map.setPosX(t),this.config.axisY&&this._map.setPosY(i)},InfinityScroll.prototype._catchElm=function(t){var i;if(t instanceof HTMLElement?i=t:"string"==typeof t&&(i=document.querySelector(t)),!i)throw new Error('Wrong type of argument "selector"');return i},InfinityScroll.prototype.destroy=function(){this._map.screenElm.removeEventListener("mousedown",this._catchFn),this._map.screenElm.removeEventListener("mousemove",this._move),this._map.screenElm.removeEventListener("mouseup",this._uncatch),this._map.screenElm.removeEventListener("touchstart",this._catchFn)},InfinityScroll.prototype._addMouseListeners=function(){this._map.screenElm.addEventListener("mousedown",this._catchFn),this._map.screenElm.addEventListener("mousemove",this._move),this._map.screenElm.addEventListener("mouseup",this._uncatch),this._map.screenElm.addEventListener("touchstart",this._catchFn)},InfinityScroll.prototype._catchUnbindedFn=function(){var i=this;return function(t){i.isCatched=!0}},InfinityScroll.Config=function(){this.triggerMenuAttributeSelector="data-infinity-scroll",this.inertia=!0,this.axisX=!0,this.axisY=!0},InfinityScroll.InertionState=function(t){this._impulseX=0,this._impulseY=0,this._screen=t,this._startX=void 0,this._startY=void 0,this._readyToUpdatePos=!0},InfinityScroll.InertionState.prototype.updateImpulses=function(t){var i=this;if(this._readyToUpdatePos){i._readyToUpdatePos=!1;var e=performance.now()-this._startDragTime,s=(t.clientX-this._startX)/e,n=(t.clientY-this._startY)/e;this._impulseX=50*s,this._impulseY=50*n,setTimeout(function(){i._readyToUpdatePos=!0},100)}},InfinityScroll.InertionState.prototype.updateStartPos=function(t){this._startX=t.clientX,this._startY=t.clientY,this._startDragTime=performance.now()},InfinityScroll.InertionState.prototype.inertionMove=function(){if(!this._screen.isCatched){var t=this,i=this._impulseX-this._impulseX/40,e=this._impulseY-this._impulseY/40;.1<Math.abs(this._impulseX-e)&&.1<Math.abs(this._impulseY-i)&&setTimeout(function(){t._screen.moveTo(i,e),t._impulseX=i,t._impulseY=e,t.inertionMove(i,e)},16)}},InfinityScroll.Overlay=function(t){this._scroll=t,this.isShowed=!1,this._elm=document.createElement("div"),this._tempMousePosX=void 0,this._tempMousePosY=void 0,this._uncatchFn=this._uncatchUnbindedFn(),this._move=this._moveUnbindedFn(),this.init()},InfinityScroll.Overlay.prototype.init=function(){var t=this._elm;t.style.position="fixed",t.style["z-index"]=1e4,t.style.display="none",t.style.height="100%",t.style.width="100%",t.style.top="0",t.style.left="0",t.style.cursor="move",this.initListeners(),document.body.appendChild(t)},InfinityScroll.Overlay.prototype.initListeners=function(){this._elm.addEventListener("mouseup",this._uncatchFn)},InfinityScroll.Overlay.prototype.hide=function(){this.isShowed&&(this._elm.style.display="none",document.body.style["user-select"]=null,this.isShowed=!1)},InfinityScroll.Overlay.prototype.show=function(){this.isShowed||(this._elm.style.display="block",document.body.style["user-select"]="none",this.isShowed=!0)},InfinityScroll.Overlay.prototype._uncatchUnbindedFn=function(){var t=this;return function(){t._scroll.isCatched=!1,t._tempMousePosX=void 0,t._tempMousePosY=void 0,t.hide()}},InfinityScroll.Overlay.prototype._moveUnbindedFn=function(){var i=this;return function(t){i.isShowed&&("mousemove"===t.type&&(i._scroll.moveTo(t.clientX-i._tempMousePosX,t.clientY-i._tempMousePosY),i._tempMousePosX=t.clientX,i._tempMousePosY=t.clientY),"touchmove"===t.type&&(i._scroll.moveTo(t.touches[0].clientX-i._tempMousePosX,t.touches[0].clientY-i._tempMousePosY),i._tempMousePosX=t.touches[0].clientX,i._tempMousePosY=t.touches[0].clientY))}},InfinityScroll.Map=function(t,i){this.width=void 0,this.height=void 0,this.posX=void 0,this.posY=void 0,this.elm=void 0,this._copies=[],this.config=i,this.screenElm=t,this.resizeFn=this.resizeUnbindedFn(),this.updateSizes(),this.init()},InfinityScroll.Map.prototype.initListeners=function(){window.addEventListener("resize",this.resizeFn)},InfinityScroll.Map.prototype.updateSizes=function(){var t=this.screenElm.getBoundingClientRect();this.width=t.width,this.height=t.height,this.posX=-t.width,this.posY=-t.height},InfinityScroll.Map.prototype.resizeUnbindedFn=function(){var i=this,e=InfinityScroll.Map.toPx,s=!1;return function(t){s||(s=!0,setTimeout(function(){s=!1,i.updateSizes(),i.setState(),i._copies.forEach(function(t){t.style.width=e(i.width),t.style.height=e(i.height)})},100))}},InfinityScroll.Map.prototype.setPosX=function(t){!isNaN(t)&&this.config.axisX&&(this.posX=this.posX+t,this.posX=this.posX<0?this.posX:-this.width,this.posX=0-2*this.width<this.posX?this.posX:-this.width,this.elm.style.left=InfinityScroll.Map.toPx(this.posX))},InfinityScroll.Map.prototype.setPosY=function(t){!isNaN(t)&&this.config.axisY&&(this.posY=this.posY+t,this.posY=this.posY<0?this.posY:-this.height,this.posY=0-2*this.height<this.posY?this.posY:-this.height,this.elm.style.top=InfinityScroll.Map.toPx(this.posY))},InfinityScroll.Map.prototype.init=function(){var t=InfinityScroll.Map.toPx,i=1;this.config.axisX&&(i*=3),this.config.axisY&&(i*=3),this.elm=document.createElement("div"),this.elm.classList.add("map"),this.elm.style["user-select"]="none";for(var e=0;e<i;e++){var s=this.screenElm.cloneNode(!0);s.style.float="left",s.style.width=t(this.width),s.style.height=t(this.height),this.elm.appendChild(s),this._copies.push(s)}this.screenElm.innerHTML="",this.screenElm.style.position="relative",this.screenElm.style.overflow="hidden",this.elm.style.position="absolute",this.setState(),this.initListeners(),this.screenElm.appendChild(this.elm)},InfinityScroll.Map.prototype.setState=function(){var t=InfinityScroll.Map.toPx;this.config.axisY&&(this.elm.style.height=t(this.height*(this.config.axisY?3:1)),this.elm.style.top=t(this.posY)),this.config.axisX&&(this.elm.style.width=t(this.width*(this.config.axisX?3:1)),this.elm.style.left=t(this.posX))},InfinityScroll.Map.toPx=function(t){return t+"px"};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZmluaXR5LXNjcmVlbi5qcyIsImluZmluaXR5LXNjcmVlbi5jb25maWcuanMiLCJpbmZpbml0eS1zY3JlZW4uaW5lcnRpb24tc3RhdGUuanMiLCJpbmZpbml0eS1zY3JlZW4ub3ZlcmxheS5qcyIsImluZmluaXR5LXNjcmVlbi5tYXAuanMiXSwibmFtZXMiOlsiSW5maW5pdHlTY3JvbGwiLCJlbG0iLCJjb25maWciLCJ0aGlzIiwiaXNDYXRjaGVkIiwiT2JqZWN0IiwiYXNzaWduIiwiQ29uZmlnIiwiX2VsbSIsIl9jYXRjaEVsbSIsIl9tYXAiLCJNYXAiLCJfb3ZlcmxheSIsIk92ZXJsYXkiLCJfaW5lcnRpb25TdGF0ZSIsIkluZXJ0aW9uU3RhdGUiLCJfY2F0Y2hGbiIsIl9jYXRjaFVuYmluZGVkRm4iLCJfdW5jYXRjaCIsIl91bmNhdGNoVW5iaW5kZWRGbiIsIl9tb3ZlIiwiX21vdmVVbmJpbmRlZEZuIiwiX3RlbXBNb3VzZVBvc1giLCJ1bmRlZmluZWQiLCJfdGVtcE1vdXNlUG9zWSIsImluaXRMaXN0ZW5lcnMiLCJwcm90b3R5cGUiLCJzZWxmIiwiZSIsImluZXJ0aWEiLCJ1cGRhdGVTdGFydFBvcyIsInR5cGUiLCJtb3ZlVG8iLCJjbGllbnRYIiwiY2xpZW50WSIsInRvdWNoZXMiLCJ1cGRhdGVJbXB1bHNlcyIsImluZXJ0aW9uTW92ZSIsIl9hZGRNb3VzZUxpc3RlbmVycyIsIngiLCJ5IiwiYXhpc1giLCJzZXRQb3NYIiwiYXhpc1kiLCJzZXRQb3NZIiwic2VsZWN0b3IiLCJIVE1MRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIkVycm9yIiwiZGVzdHJveSIsInNjcmVlbkVsbSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwidHJpZ2dlck1lbnVBdHRyaWJ1dGVTZWxlY3RvciIsInNjcmVlbiIsIl9pbXB1bHNlWCIsIl9pbXB1bHNlWSIsIl9zY3JlZW4iLCJfc3RhcnRYIiwiX3N0YXJ0WSIsIl9yZWFkeVRvVXBkYXRlUG9zIiwibW92ZVRpbWUiLCJwZXJmb3JtYW5jZSIsIm5vdyIsIl9zdGFydERyYWdUaW1lIiwic3BlZWRYIiwic3BlZWRZIiwic2V0VGltZW91dCIsInRtcEltcFgiLCJ0bXBJbXBZIiwiTWF0aCIsImFicyIsInNjcm9sbCIsIl9zY3JvbGwiLCJpc1Nob3dlZCIsImNyZWF0ZUVsZW1lbnQiLCJfdW5jYXRjaEZuIiwiaW5pdCIsImVsIiwic3R5bGUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJoaWRlIiwic2hvdyIsImNvbmZpZ1JlZiIsIndpZHRoIiwiaGVpZ2h0IiwicG9zWCIsInBvc1kiLCJfY29waWVzIiwicmVzaXplRm4iLCJyZXNpemVVbmJpbmRlZEZuIiwidXBkYXRlU2l6ZXMiLCJ3aW5kb3ciLCJzaXplcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvUHgiLCJpc0NoYW5nZWQiLCJzZXRTdGF0ZSIsImZvckVhY2giLCJjb3B5IiwiaXNOYU4iLCJuZWNlc3NhcnlDb3BpZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJpIiwiY2xvbmVOb2RlIiwicHVzaCIsImlubmVySFRNTCIsInB4Il0sIm1hcHBpbmdzIjoiQUFBQSxTQUFBQSxlQUFBQyxFQUFBQyxHQUNBRCxJQUNBRSxLQUFBQyxXQUFBLEVBQ0FELEtBQUFELE9BQUFHLE9BQUFDLE9BQUEsSUFBQU4sZUFBQU8sT0FBQUwsT0FDQUMsS0FBQUssS0FBQUwsS0FBQU0sVUFBQVIsR0FDQUUsS0FBQU8sS0FBQSxJQUFBVixlQUFBVyxJQUFBUixLQUFBSyxLQUFBTCxLQUFBRCxRQUNBQyxLQUFBUyxTQUFBLElBQUFaLGVBQUFhLFFBQUFWLE1BQ0FBLEtBQUFXLGVBQUEsSUFBQWQsZUFBQWUsY0FBQVosTUFFQUEsS0FBQWEsU0FBQWIsS0FBQWMsbUJBQ0FkLEtBQUFlLFNBQUFmLEtBQUFnQixxQkFDQWhCLEtBQUFpQixNQUFBakIsS0FBQWtCLGtCQUVBbEIsS0FBQW1CLG9CQUFBQyxFQUNBcEIsS0FBQXFCLG9CQUFBRCxFQUVBcEIs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QUgsRUFBQUcsSUFBQSxDQUNBLElBQUFMLEVBQUFsRyxLQUFBZ0QsVUFBQXdELFdBQUEsR0FDQU4sRUFBQXJCLE1BQUEsTUFBQSxPQUNBcUIsRUFBQXJCLE1BQUEsTUFBQWlCLEVBQUE5RixLQUFBbUYsT0FDQWUsRUFBQXJCLE1BQUEsT0FBQWlCLEVBQUE5RixLQUFBb0YsUUFDQXBGLEtBQUFGLElBQUFpRixZQUFBbUIsR0FDQWxHLEtBQUF1RixRQUFBa0IsS0FBQVAsR0FHQWxHLEtBQUFnRCxVQUFBMEQsVUFBQSxHQUNBMUcsS0FBQWdELFVBQUE2QixNQUFBLFNBQUEsV0FDQTdFLEtBQUFnRCxVQUFBNkIsTUFBQSxTQUFBLFNBQ0E3RSxLQUFBRixJQUFBK0UsTUFBQSxTQUFBLFdBQ0E3RSxLQUFBZ0csV0FDQWhHLEtBQUFzQixnQkFDQXRCLEtBQUFnRCxVQUFBK0IsWUFBQS9FLEtBQUFGLE1BR0FELGVBQUFXLElBQUFlLFVBQUF5RSxTQUFBLFdBQ0EsSUFBQUYsRUFBQWpHLGVBQUFXLElBQUFzRixLQUNBOUYsS0FBQUQsT0FBQXlDLFFBQ0F4QyxLQUFBRixJQUFBK0UsTUFBQSxPQUFBaUIsRUFBQTlGLEtBQUFvRixRQUFBcEYsS0FBQUQsT0FBQXlDLE1BQUEsRUFBQSxJQUNBeEMsS0FBQUYsSUFBQStFLE1BQUEsSUFBQWlCLEVBQUE5RixLQUFBc0YsT0FFQXRGLEtBQUFELE9BQUF1QyxRQUNBdEMsS0FBQUYsSUFBQStFLE1BQUEsTUFBQWlCLEVBQUE5RixLQUFBbUYsT0FBQW5GLEtBQUFELE9BQUF1QyxNQUFBLEVBQUEsSUFDQXRDLEtBQUFGLElBQUErRSxNQUFBLEtBQUFpQixFQUFBOUYsS0FBQXFGLFFBSUF4RixlQUFBVyxJQUFBc0YsS0FBQSxTQUFBYSxHQUNBLE9BQUFBLEVBQUEiLCJmaWxlIjoiaW5maW5pdHktc2NyZWVuLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEluZmluaXR5U2Nyb2xsKGVsbSwgY29uZmlnKSB7XHJcbiAgICBpZiAoZWxtKSB7XHJcbiAgICAgICAgdGhpcy5pc0NhdGNoZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IE9iamVjdC5hc3NpZ24obmV3IEluZmluaXR5U2Nyb2xsLkNvbmZpZywgY29uZmlnIHx8IHt9KTtcclxuICAgICAgICB0aGlzLl9lbG0gPSB0aGlzLl9jYXRjaEVsbShlbG0pO1xyXG4gICAgICAgIHRoaXMuX21hcCA9IG5ldyBJbmZpbml0eVNjcm9sbC5NYXAodGhpcy5fZWxtLCB0aGlzLmNvbmZpZyk7XHJcbiAgICAgICAgdGhpcy5fb3ZlcmxheSA9IG5ldyBJbmZpbml0eVNjcm9sbC5PdmVybGF5KHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX2luZXJ0aW9uU3RhdGUgPSBuZXcgSW5maW5pdHlTY3JvbGwuSW5lcnRpb25TdGF0ZSh0aGlzKTtcclxuXHJcbiAgICAgICAgdGhpcy5fY2F0Y2hGbiA9IHRoaXMuX2NhdGNoVW5iaW5kZWRGbigpO1xyXG4gICAgICAgIHRoaXMuX3VuY2F0Y2ggPSB0aGlzLl91bmNhdGNoVW5iaW5kZWRGbigpO1xyXG4gICAgICAgIHRoaXMuX21vdmUgPSB0aGlzLl9tb3ZlVW5iaW5kZWRGbigpO1xyXG5cclxuICAgICAgICB0aGlzLl90ZW1wTW91c2VQb3NYID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuX3RlbXBNb3VzZVBvc1kgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdExpc3RlbmVycygpO1xyXG4gICAgfVxyXG59XHJcblxyXG5JbmZpbml0eVNjcm9sbC5wcm90b3R5cGUuX21vdmVVbmJpbmRlZEZuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKCFzZWxmLmlzQ2F0Y2hlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoc2VsZi5jb25maWcuaW5lcnRpYSkge1xyXG4gICAgICAgICAgICBzZWxmLl9pbmVydGlvblN0YXRlLnVwZGF0ZVN0YXJ0UG9zKGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ21vdXNlbW92ZScpIHtcclxuICAgICAgICAgICAgc2VsZi5tb3ZlVG8oZS5jbGllbnRYIC0gc2VsZi5fdGVtcE1vdXNlUG9zWCwgZS5jbGllbnRZIC0gc2VsZi5fdGVtcE1vdXNlUG9zWSk7XHJcbiAgICAgICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1ggPSBlLmNsaWVudFg7XHJcbiAgICAgICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1kgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZS50eXBlID09PSAndG91Y2htb3ZlJykge1xyXG4gICAgICAgICAgICBzZWxmLm1vdmVUbyhlLnRvdWNoZXNbMF0uY2xpZW50WCAtIHNlbGYuX3RlbXBNb3VzZVBvc1gsIGUudG91Y2hlc1swXS5jbGllbnRZIC0gc2VsZi5fdGVtcE1vdXNlUG9zWSk7XHJcbiAgICAgICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1ggPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcclxuICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IGUudG91Y2hlc1swXS5jbGllbnRZO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5fdW5jYXRjaFVuYmluZGVkRm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBzZWxmLmlzQ2F0Y2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1ggPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmluZXJ0aWEpIHtcclxuICAgICAgICAgICAgc2VsZi5faW5lcnRpb25TdGF0ZS51cGRhdGVJbXB1bHNlcyhlKTtcclxuICAgICAgICAgICAgc2VsZi5faW5lcnRpb25TdGF0ZS5pbmVydGlvbk1vdmUoKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLmluaXRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLl9hZGRNb3VzZUxpc3RlbmVycygpO1xyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uICh4LCB5KSB7XHJcbiAgICB0aGlzLmNvbmZpZy5heGlzWCAmJiB0aGlzLl9tYXAuc2V0UG9zWCh4KTtcclxuICAgIHRoaXMuY29uZmlnLmF4aXNZICYmIHRoaXMuX21hcC5zZXRQb3NZKHkpO1xyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLl9jYXRjaEVsbSA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xyXG4gICAgdmFyIGVsbTtcclxuICAgIGlmIChzZWxlY3RvciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgZWxtID0gc2VsZWN0b3I7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBlbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWVsbSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV3JvbmcgdHlwZSBvZiBhcmd1bWVudCBcInNlbGVjdG9yXCInKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZWxtO1xyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLl9tYXAuc2NyZWVuRWxtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2NhdGNoRm4pO1xyXG4gICAgdGhpcy5fbWFwLnNjcmVlbkVsbS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9tb3ZlKTtcclxuICAgIHRoaXMuX21hcC5zY3JlZW5FbG0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX3VuY2F0Y2gpO1xyXG4gICAgdGhpcy5fbWFwLnNjcmVlbkVsbS5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5fY2F0Y2hGbik7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5wcm90b3R5cGUuX2FkZE1vdXNlTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5fbWFwLnNjcmVlbkVsbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9jYXRjaEZuKTtcclxuICAgIHRoaXMuX21hcC5zY3JlZW5FbG0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5fbW92ZSk7XHJcbiAgICB0aGlzLl9tYXAuc2NyZWVuRWxtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLl91bmNhdGNoKTtcclxuICAgIHRoaXMuX21hcC5zY3JlZW5FbG0uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuX2NhdGNoRm4pO1xyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLl9jYXRjaFVuYmluZGVkRm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBzZWxmLmlzQ2F0Y2hlZCA9IHRydWU7XHJcbiAgICB9XHJcbn07IiwiSW5maW5pdHlTY3JvbGwuQ29uZmlnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy50cmlnZ2VyTWVudUF0dHJpYnV0ZVNlbGVjdG9yID0gJ2RhdGEtaW5maW5pdHktc2Nyb2xsJztcclxuICAgIHRoaXMuaW5lcnRpYSA9IHRydWU7XHJcbiAgICB0aGlzLmF4aXNYID0gdHJ1ZTtcclxuICAgIHRoaXMuYXhpc1kgPSB0cnVlO1xyXG59OyIsIkluZmluaXR5U2Nyb2xsLkluZXJ0aW9uU3RhdGUgPSBmdW5jdGlvbiAoc2NyZWVuKSB7XHJcbiAgICB0aGlzLl9pbXB1bHNlWCA9IDA7XHJcbiAgICB0aGlzLl9pbXB1bHNlWSA9IDA7XHJcbiAgICB0aGlzLl9zY3JlZW4gPSBzY3JlZW47XHJcbiAgICB0aGlzLl9zdGFydFggPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl9zdGFydFkgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl9yZWFkeVRvVXBkYXRlUG9zID0gdHJ1ZTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLkluZXJ0aW9uU3RhdGUucHJvdG90eXBlLnVwZGF0ZUltcHVsc2VzID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGlmKCB0aGlzLl9yZWFkeVRvVXBkYXRlUG9zICkge1xyXG4gICAgICAgIHNlbGYuX3JlYWR5VG9VcGRhdGVQb3MgPSBmYWxzZTtcclxuICAgICAgICB2YXIgbW92ZVRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHRoaXMuX3N0YXJ0RHJhZ1RpbWU7XHJcbiAgICAgICAgdmFyIGRpc3RhbmNlWCA9IGUuY2xpZW50WCAtIHRoaXMuX3N0YXJ0WDtcclxuICAgICAgICB2YXIgZGlzdGFuY2VZID0gZS5jbGllbnRZIC0gdGhpcy5fc3RhcnRZO1xyXG4gICAgICAgIHZhciBzcGVlZFggPSBkaXN0YW5jZVggLyBtb3ZlVGltZTtcclxuICAgICAgICB2YXIgc3BlZWRZID0gZGlzdGFuY2VZIC8gbW92ZVRpbWU7XHJcbiAgICAgICAgdmFyIG0gPSA1MDtcclxuXHJcbiAgICAgICAgdGhpcy5faW1wdWxzZVggPSBzcGVlZFggKiBtO1xyXG4gICAgICAgIHRoaXMuX2ltcHVsc2VZID0gc3BlZWRZICogbTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZi5fcmVhZHlUb1VwZGF0ZVBvcyA9IHRydWU7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLkluZXJ0aW9uU3RhdGUucHJvdG90eXBlLnVwZGF0ZVN0YXJ0UG9zID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIHRoaXMuX3N0YXJ0WCA9IGUuY2xpZW50WDtcclxuICAgIHRoaXMuX3N0YXJ0WSA9IGUuY2xpZW50WTtcclxuICAgIHRoaXMuX3N0YXJ0RHJhZ1RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLkluZXJ0aW9uU3RhdGUucHJvdG90eXBlLmluZXJ0aW9uTW92ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghdGhpcy5fc2NyZWVuLmlzQ2F0Y2hlZCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgdmFyIHRtcEltcFggPSB0aGlzLl9pbXB1bHNlWCAtICh0aGlzLl9pbXB1bHNlWCAvIDQwKTtcclxuICAgICAgICB2YXIgdG1wSW1wWSA9IHRoaXMuX2ltcHVsc2VZIC0gKHRoaXMuX2ltcHVsc2VZIC8gNDApO1xyXG5cclxuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5faW1wdWxzZVggLSB0bXBJbXBZKSA+IC4xICYmIE1hdGguYWJzKHRoaXMuX2ltcHVsc2VZIC0gdG1wSW1wWCkgPiAuMSkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3NjcmVlbi5tb3ZlVG8odG1wSW1wWCwgdG1wSW1wWSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5faW1wdWxzZVggPSB0bXBJbXBYO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5faW1wdWxzZVkgPSB0bXBJbXBZO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuaW5lcnRpb25Nb3ZlKHRtcEltcFgsIHRtcEltcFkpO1xyXG4gICAgICAgICAgICB9LCAxNik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59OyIsIkluZmluaXR5U2Nyb2xsLk92ZXJsYXkgPSBmdW5jdGlvbiAoc2Nyb2xsKSB7XHJcbiAgICB0aGlzLl9zY3JvbGwgPSBzY3JvbGw7XHJcbiAgICB0aGlzLmlzU2hvd2VkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9lbG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRoaXMuX3RlbXBNb3VzZVBvc1ggPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl90ZW1wTW91c2VQb3NZID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5fdW5jYXRjaEZuID0gdGhpcy5fdW5jYXRjaFVuYmluZGVkRm4oKTtcclxuICAgIHRoaXMuX21vdmUgPSB0aGlzLl9tb3ZlVW5iaW5kZWRGbigpO1xyXG4gICAgdGhpcy5pbml0KCk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5PdmVybGF5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVsID0gdGhpcy5fZWxtO1xyXG4gICAgZWwuc3R5bGVbJ3Bvc2l0aW9uJ10gPSAnZml4ZWQnO1xyXG4gICAgZWwuc3R5bGVbJ3otaW5kZXgnXSA9IDEwMDAwO1xyXG4gICAgZWwuc3R5bGVbJ2Rpc3BsYXknXSA9ICdub25lJztcclxuICAgIGVsLnN0eWxlWydoZWlnaHQnXSA9ICcxMDAlJztcclxuICAgIGVsLnN0eWxlWyd3aWR0aCddID0gJzEwMCUnO1xyXG4gICAgZWwuc3R5bGVbJ3RvcCddID0gJzAnO1xyXG4gICAgZWwuc3R5bGVbJ2xlZnQnXSA9ICcwJztcclxuICAgIGVsLnN0eWxlWydjdXJzb3InXSA9ICdtb3ZlJztcclxuICAgIHRoaXMuaW5pdExpc3RlbmVycygpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5PdmVybGF5LnByb3RvdHlwZS5pbml0TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVsID0gdGhpcy5fZWxtO1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX3VuY2F0Y2hGbik7XHJcbiAgICAvL2VsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdmUpO1xyXG4gICAgLy9lbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLl9tb3ZlKTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5pc1Nob3dlZCkge1xyXG4gICAgICAgIHRoaXMuX2VsbS5zdHlsZVsnZGlzcGxheSddID0gJ25vbmUnO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGVbJ3VzZXItc2VsZWN0J10gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNTaG93ZWQgPSBmYWxzZTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoIXRoaXMuaXNTaG93ZWQpIHtcclxuICAgICAgICB0aGlzLl9lbG0uc3R5bGVbJ2Rpc3BsYXknXSA9ICdibG9jayc7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZVsndXNlci1zZWxlY3QnXSA9ICdub25lJztcclxuICAgICAgICB0aGlzLmlzU2hvd2VkID0gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLl91bmNhdGNoVW5iaW5kZWRGbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5fc2Nyb2xsLmlzQ2F0Y2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1ggPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IHVuZGVmaW5lZDtcclxuICAgICAgICBzZWxmLmhpZGUoKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLl9tb3ZlVW5iaW5kZWRGbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmIChzZWxmLmlzU2hvd2VkKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZW1vdmUnKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9zY3JvbGwubW92ZVRvKGUuY2xpZW50WCAtIHNlbGYuX3RlbXBNb3VzZVBvc1gsIGUuY2xpZW50WSAtIHNlbGYuX3RlbXBNb3VzZVBvc1kpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1kgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUudHlwZSA9PT0gJ3RvdWNobW92ZScpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3Njcm9sbC5tb3ZlVG8oZS50b3VjaGVzWzBdLmNsaWVudFggLSBzZWxmLl90ZW1wTW91c2VQb3NYLCBlLnRvdWNoZXNbMF0uY2xpZW50WSAtIHNlbGYuX3RlbXBNb3VzZVBvc1kpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IGUudG91Y2hlc1swXS5jbGllbnRYO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IGUudG91Y2hlc1swXS5jbGllbnRZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59OyIsIkluZmluaXR5U2Nyb2xsLk1hcCA9IGZ1bmN0aW9uIChzY3JlZW5FbG0sIGNvbmZpZ1JlZikge1xyXG4gICAgdGhpcy53aWR0aCA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuaGVpZ2h0ID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5wb3NYID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5wb3NZID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5lbG0gPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl9jb3BpZXMgPSBbXTtcclxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnUmVmO1xyXG4gICAgdGhpcy5zY3JlZW5FbG0gPSBzY3JlZW5FbG07XHJcbiAgICB0aGlzLnJlc2l6ZUZuID0gdGhpcy5yZXNpemVVbmJpbmRlZEZuKCk7XHJcblxyXG4gICAgdGhpcy51cGRhdGVTaXplcygpO1xyXG4gICAgdGhpcy5pbml0KCk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLmluaXRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemVGbik7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLnVwZGF0ZVNpemVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNpemVzID0gdGhpcy5zY3JlZW5FbG0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICB0aGlzLndpZHRoID0gc2l6ZXMud2lkdGg7XHJcbiAgICB0aGlzLmhlaWdodCA9IHNpemVzLmhlaWdodDtcclxuICAgIHRoaXMucG9zWCA9IC1zaXplcy53aWR0aDtcclxuICAgIHRoaXMucG9zWSA9IC1zaXplcy5oZWlnaHQ7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLnJlc2l6ZVVuYmluZGVkRm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdG9QeCA9IEluZmluaXR5U2Nyb2xsLk1hcC50b1B4O1xyXG4gICAgdmFyIGlzQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKCFpc0NoYW5nZWQpIHtcclxuICAgICAgICAgICAgaXNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpc0NoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlU2l6ZXMoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0U3RhdGUoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX2NvcGllc1xyXG4gICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChjb3B5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcHkuc3R5bGVbJ3dpZHRoJ10gPSB0b1B4KHNlbGYud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3B5LnN0eWxlWydoZWlnaHQnXSA9IHRvUHgoc2VsZi5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk1hcC5wcm90b3R5cGUuc2V0UG9zWCA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICBpZiAoIWlzTmFOKHgpICYmIHRoaXMuY29uZmlnLmF4aXNYKSB7XHJcbiAgICAgICAgdGhpcy5wb3NYID0gdGhpcy5wb3NYICsgeDtcclxuICAgICAgICB0aGlzLnBvc1ggPSB0aGlzLnBvc1ggPCAwID8gdGhpcy5wb3NYIDogLXRoaXMud2lkdGg7XHJcbiAgICAgICAgdGhpcy5wb3NYID0gKDAgLSB0aGlzLndpZHRoICogMiA8IHRoaXMucG9zWCkgPyB0aGlzLnBvc1ggOiAtdGhpcy53aWR0aDtcclxuICAgICAgICB0aGlzLmVsbS5zdHlsZVsnbGVmdCddID0gSW5maW5pdHlTY3JvbGwuTWFwLnRvUHgodGhpcy5wb3NYKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk1hcC5wcm90b3R5cGUuc2V0UG9zWSA9IGZ1bmN0aW9uICh5KSB7XHJcbiAgICBpZiAoIWlzTmFOKHkpICYmIHRoaXMuY29uZmlnLmF4aXNZKSB7XHJcbiAgICAgICAgdGhpcy5wb3NZID0gdGhpcy5wb3NZICsgeTtcclxuICAgICAgICB0aGlzLnBvc1kgPSB0aGlzLnBvc1kgPCAwID8gdGhpcy5wb3NZIDogLXRoaXMuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMucG9zWSA9ICgwIC0gdGhpcy5oZWlnaHQgKiAyIDwgdGhpcy5wb3NZKSA/IHRoaXMucG9zWSA6IC10aGlzLmhlaWdodDtcclxuXHJcbiAgICAgICAgdGhpcy5lbG0uc3R5bGVbJ3RvcCddID0gSW5maW5pdHlTY3JvbGwuTWFwLnRvUHgodGhpcy5wb3NZKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk1hcC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB0b1B4ID0gSW5maW5pdHlTY3JvbGwuTWFwLnRvUHg7XHJcbiAgICB2YXIgbmVjZXNzYXJ5Q29waWVzID0gMTtcclxuICAgIGlmICh0aGlzLmNvbmZpZy5heGlzWCkge1xyXG4gICAgICAgIG5lY2Vzc2FyeUNvcGllcyAqPSAzO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuY29uZmlnLmF4aXNZKSB7XHJcbiAgICAgICAgbmVjZXNzYXJ5Q29waWVzICo9IDM7XHJcbiAgICB9XHJcbiAgICB0aGlzLmVsbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgdGhpcy5lbG0uY2xhc3NMaXN0LmFkZCgnbWFwJyk7XHJcbiAgICB0aGlzLmVsbS5zdHlsZVsndXNlci1zZWxlY3QnXSA9ICdub25lJztcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5lY2Vzc2FyeUNvcGllczsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSB0aGlzLnNjcmVlbkVsbS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgY29weS5zdHlsZVsnZmxvYXQnXSA9ICdsZWZ0JztcclxuICAgICAgICBjb3B5LnN0eWxlWyd3aWR0aCddID0gdG9QeCh0aGlzLndpZHRoKTtcclxuICAgICAgICBjb3B5LnN0eWxlWydoZWlnaHQnXSA9IHRvUHgodGhpcy5oZWlnaHQpO1xyXG4gICAgICAgIHRoaXMuZWxtLmFwcGVuZENoaWxkKGNvcHkpO1xyXG4gICAgICAgIHRoaXMuX2NvcGllcy5wdXNoKGNvcHkpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc2NyZWVuRWxtLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICB0aGlzLnNjcmVlbkVsbS5zdHlsZVsncG9zaXRpb24nXSA9ICdyZWxhdGl2ZSc7XHJcbiAgICB0aGlzLnNjcmVlbkVsbS5zdHlsZVsnb3ZlcmZsb3cnXSA9ICdoaWRkZW4nO1xyXG4gICAgdGhpcy5lbG0uc3R5bGVbJ3Bvc2l0aW9uJ10gPSAnYWJzb2x1dGUnO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgpO1xyXG4gICAgdGhpcy5pbml0TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnNjcmVlbkVsbS5hcHBlbmRDaGlsZCh0aGlzLmVsbSk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHRvUHggPSBJbmZpbml0eVNjcm9sbC5NYXAudG9QeDtcclxuICAgIGlmICh0aGlzLmNvbmZpZy5heGlzWSkge1xyXG4gICAgICAgIHRoaXMuZWxtLnN0eWxlWydoZWlnaHQnXSA9IHRvUHgodGhpcy5oZWlnaHQgKiAodGhpcy5jb25maWcuYXhpc1kgPyAzIDogMSkpO1xyXG4gICAgICAgIHRoaXMuZWxtLnN0eWxlWyd0b3AnXSA9IHRvUHgodGhpcy5wb3NZKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmNvbmZpZy5heGlzWCkge1xyXG4gICAgICAgIHRoaXMuZWxtLnN0eWxlWyd3aWR0aCddID0gdG9QeCh0aGlzLndpZHRoICogKHRoaXMuY29uZmlnLmF4aXNYID8gMyA6IDEpKTtcclxuICAgICAgICB0aGlzLmVsbS5zdHlsZVsnbGVmdCddID0gdG9QeCh0aGlzLnBvc1gpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwuTWFwLnRvUHggPSBmdW5jdGlvbiAocHgpIHtcclxuICAgIHJldHVybiBweCArICdweCc7XHJcbn07Il19
