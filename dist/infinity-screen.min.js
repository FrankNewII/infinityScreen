function InfinityScroll(t,i){t&&(this.isCatched=!1,this.config=Object.assign(new InfinityScroll.Config,i||{}),this._elm=this._catchElm(t),this._map=new InfinityScroll.Map(this._elm,this.config),this._overlay=new InfinityScroll.Overlay(this),this._inertionState=new InfinityScroll.InertionState(this),this._catchFn=this._catchUnbindedFn(),this._uncatch=this._uncatchUnbindedFn(),this._move=this._moveUnbindedFn(),this._tempMousePosX=void 0,this._tempMousePosY=void 0,this.initListeners())}InfinityScroll.prototype._moveUnbindedFn=function(){var i=this;return function(t){i.isCatched&&(i.config.inertia&&i._inertionState.updateStartPos(t),"mousemove"===t.type&&(i.moveTo(t.clientX-i._tempMousePosX,t.clientY-i._tempMousePosY),i._tempMousePosX=t.clientX,i._tempMousePosY=t.clientY),"touchmove"===t.type&&(i.moveTo(t.touches[0].clientX-i._tempMousePosX,t.touches[0].clientY-i._tempMousePosY),i._tempMousePosX=t.touches[0].clientX,i._tempMousePosY=t.touches[0].clientY))}},InfinityScroll.prototype._uncatchUnbindedFn=function(){var i=this;return function(t){i.isCatched=!1,i._tempMousePosX=void 0,i._tempMousePosY=void 0,i.config.inertia&&i._inertionState.updateImpulses(t)}},InfinityScroll.prototype.initListeners=function(){this._addMouseListeners()},InfinityScroll.prototype.moveTo=function(t,i){this.config.axisX&&this._map.setPosX(t),this.config.axisY&&this._map.setPosY(i)},InfinityScroll.prototype._catchElm=function(t){var i;if(t instanceof HTMLElement?i=t:"string"==typeof t&&(i=document.querySelector(t)),!i)throw new Error('Wrong type of argument "selector"');return i},InfinityScroll.prototype.destroy=function(){this._map.screenElm.removeEventListener("mousedown",this._catchFn),this._map.screenElm.removeEventListener("mousemove",this._move),this._map.screenElm.removeEventListener("mouseup",this._uncatch),this._map.screenElm.removeEventListener("touchstart",this._catchFn)},InfinityScroll.prototype._addMouseListeners=function(){this._map.screenElm.addEventListener("mousedown",this._catchFn),this._map.screenElm.addEventListener("mousemove",this._move),this._map.screenElm.addEventListener("mouseup",this._uncatch),this._map.screenElm.addEventListener("touchstart",this._catchFn)},InfinityScroll.prototype._catchUnbindedFn=function(){var i=this;return function(t){i.isCatched=!0}},InfinityScroll.Config=function(){this.triggerMenuAttributeSelector="data-infinity-scroll",this.inertia=!0,this.axisX=!0,this.axisY=!0},InfinityScroll.InertionState=function(t){this._impulseX=0,this._impulseY=0,this._screen=t,this._startX=void 0,this._startY=void 0},InfinityScroll.InertionState.prototype.updateImpulses=function(t){var i=performance.now()-this._startDragTime,e=(t.clientX-this._startX)/i,s=(t.clientY-this._startY)/i;this._impulseX=50*e,this._impulseY=50*s},InfinityScroll.InertionState.prototype.updateStartPos=function(t){this._startX=t.clientX,this._startY=t.clientY,this._startDragTime=performance.now()},InfinityScroll.InertionState.prototype.inertionMove=function(){if(!this._screen.isCatched){var t=this,i=this._impulseX-this._impulseX/40,e=this._impulseY-this._impulseY/40;.1<Math.abs(this._impulseX-e)&&.1<Math.abs(this._impulseY-i)&&setTimeout(function(){t._screen.moveTo(i,e),t._impulseX=i,t._impulseY=e,t.inertionMove(i,e)},16)}},InfinityScroll.Overlay=function(t){this._scroll=t,this.isShowed=!1,this._elm=document.createElement("div"),this._tempMousePosX=void 0,this._tempMousePosY=void 0,this._uncatchFn=this._uncatchUnbindedFn(),this._move=this._moveUnbindedFn(),this.init()},InfinityScroll.Overlay.prototype.init=function(){var t=this._elm;t.style.position="fixed",t.style["z-index"]=1e4,t.style.display="none",t.style.height="100%",t.style.width="100%",t.style.top="0",t.style.left="0",t.style.cursor="move",this.initListeners(),document.body.appendChild(t)},InfinityScroll.Overlay.prototype.initListeners=function(){this._elm.addEventListener("mouseup",this._uncatchFn)},InfinityScroll.Overlay.prototype.hide=function(){this.isShowed&&(this._elm.style.display="none",document.body.style["user-select"]=null,this.isShowed=!1)},InfinityScroll.Overlay.prototype.show=function(){this.isShowed||(this._elm.style.display="block",document.body.style["user-select"]="none",this.isShowed=!0)},InfinityScroll.Overlay.prototype._uncatchUnbindedFn=function(){var t=this;return function(){t._scroll.isCatched=!1,t._tempMousePosX=void 0,t._tempMousePosY=void 0,t.hide()}},InfinityScroll.Overlay.prototype._moveUnbindedFn=function(){var i=this;return function(t){i.isShowed&&("mousemove"===t.type&&(i._scroll.moveTo(t.clientX-i._tempMousePosX,t.clientY-i._tempMousePosY),i._tempMousePosX=t.clientX,i._tempMousePosY=t.clientY),"touchmove"===t.type&&(i._scroll.moveTo(t.touches[0].clientX-i._tempMousePosX,t.touches[0].clientY-i._tempMousePosY),i._tempMousePosX=t.touches[0].clientX,i._tempMousePosY=t.touches[0].clientY))}},InfinityScroll.Map=function(t,i){this.width=void 0,this.height=void 0,this.posX=void 0,this.posY=void 0,this.elm=void 0,this._copies=[],this.config=i,this.screenElm=t,this.resizeFn=this.resizeUnbindedFn(),this.updateSizes(),this.init()},InfinityScroll.Map.prototype.initListeners=function(){window.addEventListener("resize",this.resizeFn)},InfinityScroll.Map.prototype.updateSizes=function(){var t=this.screenElm.getBoundingClientRect();this.width=t.width,this.height=t.height,this.posX=-t.width,this.posY=-t.height},InfinityScroll.Map.prototype.resizeUnbindedFn=function(){var i=this,e=InfinityScroll.Map.toPx,s=!1;return function(t){s||(s=!0,setTimeout(function(){s=!1,i.updateSizes(),i.setState(),i._copies.forEach(function(t){t.style.width=e(i.width),t.style.height=e(i.height)})},100))}},InfinityScroll.Map.prototype.setPosX=function(t){!isNaN(t)&&this.config.axisX&&(this.posX=this.posX+t,this.posX=this.posX<0?this.posX:-this.width,this.posX=0-2*this.width<this.posX?this.posX:-this.width,this.elm.style.left=InfinityScroll.Map.toPx(this.posX))},InfinityScroll.Map.prototype.setPosY=function(t){!isNaN(t)&&this.config.axisY&&(this.posY=this.posY+t,this.posY=this.posY<0?this.posY:-this.height,this.posY=0-2*this.height<this.posY?this.posY:-this.height,this.elm.style.top=InfinityScroll.Map.toPx(this.posY))},InfinityScroll.Map.prototype.init=function(){var t=InfinityScroll.Map.toPx,i=1;this.config.axisX&&(i*=3),this.config.axisY&&(i*=3),this.elm=document.createElement("div"),this.elm.classList.add("map"),this.elm.style["user-select"]="none";for(var e=0;e<i;e++){var s=this.screenElm.cloneNode(!0);s.style.float="left",s.style.width=t(this.width),s.style.height=t(this.height),this.elm.appendChild(s),this._copies.push(s)}this.screenElm.innerHTML="",this.screenElm.style.position="relative",this.screenElm.style.overflow="hidden",this.elm.style.position="absolute",this.setState(),this.initListeners(),this.screenElm.appendChild(this.elm)},InfinityScroll.Map.prototype.setState=function(){var t=InfinityScroll.Map.toPx;this.config.axisY&&(this.elm.style.height=t(this.height*(this.config.axisY?3:1)),this.elm.style.top=t(this.posY)),this.config.axisX&&(this.elm.style.width=t(this.width*(this.config.axisX?3:1)),this.elm.style.left=t(this.posX))},InfinityScroll.Map.toPx=function(t){return t+"px"};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZmluaXR5LXNjcmVlbi5qcyIsImluZmluaXR5LXNjcmVlbi5jb25maWcuanMiLCJpbmZpbml0eS1zY3JlZW4uaW5lcnRpb24tc3RhdGUuanMiLCJpbmZpbml0eS1zY3JlZW4ub3ZlcmxheS5qcyIsImluZmluaXR5LXNjcmVlbi5tYXAuanMiXSwibmFtZXMiOlsiSW5maW5pdHlTY3JvbGwiLCJlbG0iLCJjb25maWciLCJ0aGlzIiwiaXNDYXRjaGVkIiwiT2JqZWN0IiwiYXNzaWduIiwiQ29uZmlnIiwiX2VsbSIsIl9jYXRjaEVsbSIsIl9tYXAiLCJNYXAiLCJfb3ZlcmxheSIsIk92ZXJsYXkiLCJfaW5lcnRpb25TdGF0ZSIsIkluZXJ0aW9uU3RhdGUiLCJfY2F0Y2hGbiIsIl9jYXRjaFVuYmluZGVkRm4iLCJfdW5jYXRjaCIsIl91bmNhdGNoVW5iaW5kZWRGbiIsIl9tb3ZlIiwiX21vdmVVbmJpbmRlZEZuIiwiX3RlbXBNb3VzZVBvc1giLCJ1bmRlZmluZWQiLCJfdGVtcE1vdXNlUG9zWSIsImluaXRMaXN0ZW5lcnMiLCJwcm90b3R5cGUiLCJzZWxmIiwiZSIsImluZXJ0aWEiLCJ1cGRhdGVTdGFydFBvcyIsInR5cGUiLCJtb3ZlVG8iLCJjbGllbnRYIiwiY2xpZW50WSIsInRvdWNoZXMiLCJ1cGRhdGVJbXB1bHNlcyIsIl9hZGRNb3VzZUxpc3RlbmVycyIsIngiLCJ5IiwiYXhpc1giLCJzZXRQb3NYIiwiYXhpc1kiLCJzZXRQb3NZIiwic2VsZWN0b3IiLCJIVE1MRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIkVycm9yIiwiZGVzdHJveSIsInNjcmVlbkVsbSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwidHJpZ2dlck1lbnVBdHRyaWJ1dGVTZWxlY3RvciIsInNjcmVlbiIsIl9pbXB1bHNlWCIsIl9pbXB1bHNlWSIsIl9zY3JlZW4iLCJfc3RhcnRYIiwiX3N0YXJ0WSIsIm1vdmVUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJfc3RhcnREcmFnVGltZSIsInNwZWVkWCIsInNwZWVkWSIsImluZXJ0aW9uTW92ZSIsInRtcEltcFgiLCJ0bXBJbXBZIiwiTWF0aCIsImFicyIsInNldFRpbWVvdXQiLCJzY3JvbGwiLCJfc2Nyb2xsIiwiaXNTaG93ZWQiLCJjcmVhdGVFbGVtZW50IiwiX3VuY2F0Y2hGbiIsImluaXQiLCJlbCIsInN0eWxlIiwiYm9keSIsImFwcGVuZENoaWxkIiwiaGlkZSIsInNob3ciLCJjb25maWdSZWYiLCJ3aWR0aCIsImhlaWdodCIsInBvc1giLCJwb3NZIiwiX2NvcGllcyIsInJlc2l6ZUZuIiwicmVzaXplVW5iaW5kZWRGbiIsInVwZGF0ZVNpemVzIiwid2luZG93Iiwic2l6ZXMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b1B4IiwiaXNDaGFuZ2VkIiwic2V0U3RhdGUiLCJmb3JFYWNoIiwiY29weSIsImlzTmFOIiwibmVjZXNzYXJ5Q29waWVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiaSIsImNsb25lTm9kZSIsInB1c2giLCJpbm5lckhUTUwiLCJweCJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBQUEsZUFBQUMsRUFBQUMsR0FDQUQsSUFDQUUsS0FBQUMsV0FBQSxFQUNBRCxLQUFBRCxPQUFBRyxPQUFBQyxPQUFBLElBQUFOLGVBQUFPLE9BQUFMLE9BQ0FDLEtBQUFLLEtBQUFMLEtBQUFNLFVBQUFSLEdBQ0FFLEtBQUFPLEtBQUEsSUFBQVYsZUFBQVcsSUFBQVIsS0FBQUssS0FBQUwsS0FBQUQsUUFDQUMsS0FBQVMsU0FBQSxJQUFBWixlQUFBYSxRQUFBVixNQUNBQSxLQUFBVyxlQUFBLElBQUFkLGVBQUFlLGNBQUFaLE1BRUFBLEtBQUFhLFNBQUFiLEtBQUFjLG1CQUNBZCxLQUFBZSxTQUFBZixLQUFBZ0IscUJBQ0FoQixLQUFBaUIsTUFBQWpCLEtBQUFrQixrQkFFQWxCLEtBQUFtQixvQkFBQUMsRUFDQXBCLEtBQUFxQixvQkFBQUQsRUFFQXBCLEtBQUFzQixpQkFJQXpCLGVBQUEw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bkYsS0FBQUYsSUFBQWdGLFlBQUFtQixHQUNBakcsS0FBQXNGLFFBQUFrQixLQUFBUCxHQUdBakcsS0FBQStDLFVBQUEwRCxVQUFBLEdBQ0F6RyxLQUFBK0MsVUFBQTZCLE1BQUEsU0FBQSxXQUNBNUUsS0FBQStDLFVBQUE2QixNQUFBLFNBQUEsU0FDQTVFLEtBQUFGLElBQUE4RSxNQUFBLFNBQUEsV0FDQTVFLEtBQUErRixXQUNBL0YsS0FBQXNCLGdCQUNBdEIsS0FBQStDLFVBQUErQixZQUFBOUUsS0FBQUYsTUFHQUQsZUFBQVcsSUFBQWUsVUFBQXdFLFNBQUEsV0FDQSxJQUFBRixFQUFBaEcsZUFBQVcsSUFBQXFGLEtBQ0E3RixLQUFBRCxPQUFBd0MsUUFDQXZDLEtBQUFGLElBQUE4RSxNQUFBLE9BQUFpQixFQUFBN0YsS0FBQW1GLFFBQUFuRixLQUFBRCxPQUFBd0MsTUFBQSxFQUFBLElBQ0F2QyxLQUFBRixJQUFBOEUsTUFBQSxJQUFBaUIsRUFBQTdGLEtBQUFxRixPQUVBckYsS0FBQUQsT0FBQXNDLFFBQ0FyQyxLQUFBRixJQUFBOEUsTUFBQSxNQUFBaUIsRUFBQTdGLEtBQUFrRixPQUFBbEYsS0FBQUQsT0FBQXNDLE1BQUEsRUFBQSxJQUNBckMsS0FBQUYsSUFBQThFLE1BQUEsS0FBQWlCLEVBQUE3RixLQUFBb0YsUUFJQXZGLGVBQUFXLElBQUFxRixLQUFBLFNBQUFhLEdBQ0EsT0FBQUEsRUFBQSIsImZpbGUiOiJpbmZpbml0eS1zY3JlZW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gSW5maW5pdHlTY3JvbGwoZWxtLCBjb25maWcpIHtcclxuICAgIGlmIChlbG0pIHtcclxuICAgICAgICB0aGlzLmlzQ2F0Y2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29uZmlnID0gT2JqZWN0LmFzc2lnbihuZXcgSW5maW5pdHlTY3JvbGwuQ29uZmlnLCBjb25maWcgfHwge30pO1xyXG4gICAgICAgIHRoaXMuX2VsbSA9IHRoaXMuX2NhdGNoRWxtKGVsbSk7XHJcbiAgICAgICAgdGhpcy5fbWFwID0gbmV3IEluZmluaXR5U2Nyb2xsLk1hcCh0aGlzLl9lbG0sIHRoaXMuY29uZmlnKTtcclxuICAgICAgICB0aGlzLl9vdmVybGF5ID0gbmV3IEluZmluaXR5U2Nyb2xsLk92ZXJsYXkodGhpcyk7XHJcbiAgICAgICAgdGhpcy5faW5lcnRpb25TdGF0ZSA9IG5ldyBJbmZpbml0eVNjcm9sbC5JbmVydGlvblN0YXRlKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLl9jYXRjaEZuID0gdGhpcy5fY2F0Y2hVbmJpbmRlZEZuKCk7XHJcbiAgICAgICAgdGhpcy5fdW5jYXRjaCA9IHRoaXMuX3VuY2F0Y2hVbmJpbmRlZEZuKCk7XHJcbiAgICAgICAgdGhpcy5fbW92ZSA9IHRoaXMuX21vdmVVbmJpbmRlZEZuKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3RlbXBNb3VzZVBvc1ggPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fdGVtcE1vdXNlUG9zWSA9IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5fbW92ZVVuYmluZGVkRm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoIXNlbGYuaXNDYXRjaGVkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5pbmVydGlhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX2luZXJ0aW9uU3RhdGUudXBkYXRlU3RhcnRQb3MoZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZS50eXBlID09PSAnbW91c2Vtb3ZlJykge1xyXG4gICAgICAgICAgICBzZWxmLm1vdmVUbyhlLmNsaWVudFggLSBzZWxmLl90ZW1wTW91c2VQb3NYLCBlLmNsaWVudFkgLSBzZWxmLl90ZW1wTW91c2VQb3NZKTtcclxuICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IGUuY2xpZW50WTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChlLnR5cGUgPT09ICd0b3VjaG1vdmUnKSB7XHJcbiAgICAgICAgICAgIHNlbGYubW92ZVRvKGUudG91Y2hlc1swXS5jbGllbnRYIC0gc2VsZi5fdGVtcE1vdXNlUG9zWCwgZS50b3VjaGVzWzBdLmNsaWVudFkgLSBzZWxmLl90ZW1wTW91c2VQb3NZKTtcclxuICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IGUudG91Y2hlc1swXS5jbGllbnRYO1xyXG4gICAgICAgICAgICBzZWxmLl90ZW1wTW91c2VQb3NZID0gZS50b3VjaGVzWzBdLmNsaWVudFk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLl91bmNhdGNoVW5iaW5kZWRGbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHNlbGYuaXNDYXRjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBzZWxmLl90ZW1wTW91c2VQb3NZID0gdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICBpZiAoc2VsZi5jb25maWcuaW5lcnRpYSkge1xyXG4gICAgICAgICAgICBzZWxmLl9pbmVydGlvblN0YXRlLnVwZGF0ZUltcHVsc2VzKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5pbml0TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5fYWRkTW91c2VMaXN0ZW5lcnMoKTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5tb3ZlVG8gPSBmdW5jdGlvbiAoeCwgeSkge1xyXG4gICAgdGhpcy5jb25maWcuYXhpc1ggJiYgdGhpcy5fbWFwLnNldFBvc1goeCk7XHJcbiAgICB0aGlzLmNvbmZpZy5heGlzWSAmJiB0aGlzLl9tYXAuc2V0UG9zWSh5KTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5fY2F0Y2hFbG0gPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcclxuICAgIHZhciBlbG07XHJcbiAgICBpZiAoc2VsZWN0b3IgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGVsbSA9IHNlbGVjdG9yO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgZWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFlbG0pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dyb25nIHR5cGUgb2YgYXJndW1lbnQgXCJzZWxlY3RvclwiJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVsbTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5fbWFwLnNjcmVlbkVsbS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9jYXRjaEZuKTtcclxuICAgIHRoaXMuX21hcC5zY3JlZW5FbG0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5fbW92ZSk7XHJcbiAgICB0aGlzLl9tYXAuc2NyZWVuRWxtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLl91bmNhdGNoKTtcclxuICAgIHRoaXMuX21hcC5zY3JlZW5FbG0ucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuX2NhdGNoRm4pO1xyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwucHJvdG90eXBlLl9hZGRNb3VzZUxpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuX21hcC5zY3JlZW5FbG0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5fY2F0Y2hGbik7XHJcbiAgICB0aGlzLl9tYXAuc2NyZWVuRWxtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdmUpO1xyXG4gICAgdGhpcy5fbWFwLnNjcmVlbkVsbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5fdW5jYXRjaCk7XHJcbiAgICB0aGlzLl9tYXAuc2NyZWVuRWxtLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLl9jYXRjaEZuKTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLnByb3RvdHlwZS5fY2F0Y2hVbmJpbmRlZEZuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgc2VsZi5pc0NhdGNoZWQgPSB0cnVlO1xyXG4gICAgfVxyXG59OyIsIkluZmluaXR5U2Nyb2xsLkNvbmZpZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMudHJpZ2dlck1lbnVBdHRyaWJ1dGVTZWxlY3RvciA9ICdkYXRhLWluZmluaXR5LXNjcm9sbCc7XHJcbiAgICB0aGlzLmluZXJ0aWEgPSB0cnVlO1xyXG4gICAgdGhpcy5heGlzWCA9IHRydWU7XHJcbiAgICB0aGlzLmF4aXNZID0gdHJ1ZTtcclxufTsiLCJJbmZpbml0eVNjcm9sbC5JbmVydGlvblN0YXRlID0gZnVuY3Rpb24gKHNjcmVlbikge1xyXG4gICAgdGhpcy5faW1wdWxzZVggPSAwO1xyXG4gICAgdGhpcy5faW1wdWxzZVkgPSAwO1xyXG4gICAgdGhpcy5fc2NyZWVuID0gc2NyZWVuO1xyXG4gICAgdGhpcy5fc3RhcnRYID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5fc3RhcnRZID0gdW5kZWZpbmVkO1xyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwuSW5lcnRpb25TdGF0ZS5wcm90b3R5cGUudXBkYXRlSW1wdWxzZXMgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgdmFyIG1vdmVUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSB0aGlzLl9zdGFydERyYWdUaW1lO1xyXG4gICAgdmFyIGRpc3RhbmNlWCA9IGUuY2xpZW50WCAtIHRoaXMuX3N0YXJ0WDtcclxuICAgIHZhciBkaXN0YW5jZVkgPSBlLmNsaWVudFkgLSB0aGlzLl9zdGFydFk7XHJcbiAgICB2YXIgc3BlZWRYID0gZGlzdGFuY2VYIC8gbW92ZVRpbWU7XHJcbiAgICB2YXIgc3BlZWRZID0gZGlzdGFuY2VZIC8gbW92ZVRpbWU7XHJcbiAgICB2YXIgbSA9IDUwO1xyXG5cclxuICAgIHRoaXMuX2ltcHVsc2VYID0gc3BlZWRYICogbTtcclxuICAgIHRoaXMuX2ltcHVsc2VZID0gc3BlZWRZICogbTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLkluZXJ0aW9uU3RhdGUucHJvdG90eXBlLnVwZGF0ZVN0YXJ0UG9zID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIHRoaXMuX3N0YXJ0WCA9IGUuY2xpZW50WDtcclxuICAgIHRoaXMuX3N0YXJ0WSA9IGUuY2xpZW50WTtcclxuICAgIHRoaXMuX3N0YXJ0RHJhZ1RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLkluZXJ0aW9uU3RhdGUucHJvdG90eXBlLmluZXJ0aW9uTW92ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghdGhpcy5fc2NyZWVuLmlzQ2F0Y2hlZCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgdmFyIHRtcEltcFggPSB0aGlzLl9pbXB1bHNlWCAtICh0aGlzLl9pbXB1bHNlWCAvIDQwKTtcclxuICAgICAgICB2YXIgdG1wSW1wWSA9IHRoaXMuX2ltcHVsc2VZIC0gKHRoaXMuX2ltcHVsc2VZIC8gNDApO1xyXG5cclxuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5faW1wdWxzZVggLSB0bXBJbXBZKSA+IC4xICYmIE1hdGguYWJzKHRoaXMuX2ltcHVsc2VZIC0gdG1wSW1wWCkgPiAuMSkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3NjcmVlbi5tb3ZlVG8odG1wSW1wWCwgdG1wSW1wWSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5faW1wdWxzZVggPSB0bXBJbXBYO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5faW1wdWxzZVkgPSB0bXBJbXBZO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuaW5lcnRpb25Nb3ZlKHRtcEltcFgsIHRtcEltcFkpO1xyXG4gICAgICAgICAgICB9LCAxNik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59OyIsIkluZmluaXR5U2Nyb2xsLk92ZXJsYXkgPSBmdW5jdGlvbiAoc2Nyb2xsKSB7XHJcbiAgICB0aGlzLl9zY3JvbGwgPSBzY3JvbGw7XHJcbiAgICB0aGlzLmlzU2hvd2VkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9lbG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRoaXMuX3RlbXBNb3VzZVBvc1ggPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl90ZW1wTW91c2VQb3NZID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5fdW5jYXRjaEZuID0gdGhpcy5fdW5jYXRjaFVuYmluZGVkRm4oKTtcclxuICAgIHRoaXMuX21vdmUgPSB0aGlzLl9tb3ZlVW5iaW5kZWRGbigpO1xyXG4gICAgdGhpcy5pbml0KCk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5PdmVybGF5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVsID0gdGhpcy5fZWxtO1xyXG4gICAgZWwuc3R5bGVbJ3Bvc2l0aW9uJ10gPSAnZml4ZWQnO1xyXG4gICAgZWwuc3R5bGVbJ3otaW5kZXgnXSA9IDEwMDAwO1xyXG4gICAgZWwuc3R5bGVbJ2Rpc3BsYXknXSA9ICdub25lJztcclxuICAgIGVsLnN0eWxlWydoZWlnaHQnXSA9ICcxMDAlJztcclxuICAgIGVsLnN0eWxlWyd3aWR0aCddID0gJzEwMCUnO1xyXG4gICAgZWwuc3R5bGVbJ3RvcCddID0gJzAnO1xyXG4gICAgZWwuc3R5bGVbJ2xlZnQnXSA9ICcwJztcclxuICAgIGVsLnN0eWxlWydjdXJzb3InXSA9ICdtb3ZlJztcclxuICAgIHRoaXMuaW5pdExpc3RlbmVycygpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5PdmVybGF5LnByb3RvdHlwZS5pbml0TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVsID0gdGhpcy5fZWxtO1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX3VuY2F0Y2hGbik7XHJcbiAgICAvL2VsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdmUpO1xyXG4gICAgLy9lbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLl9tb3ZlKTtcclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5pc1Nob3dlZCkge1xyXG4gICAgICAgIHRoaXMuX2VsbS5zdHlsZVsnZGlzcGxheSddID0gJ25vbmUnO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGVbJ3VzZXItc2VsZWN0J10gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNTaG93ZWQgPSBmYWxzZTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoIXRoaXMuaXNTaG93ZWQpIHtcclxuICAgICAgICB0aGlzLl9lbG0uc3R5bGVbJ2Rpc3BsYXknXSA9ICdibG9jayc7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZVsndXNlci1zZWxlY3QnXSA9ICdub25lJztcclxuICAgICAgICB0aGlzLmlzU2hvd2VkID0gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLl91bmNhdGNoVW5iaW5kZWRGbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5fc2Nyb2xsLmlzQ2F0Y2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1ggPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IHVuZGVmaW5lZDtcclxuICAgICAgICBzZWxmLmhpZGUoKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk92ZXJsYXkucHJvdG90eXBlLl9tb3ZlVW5iaW5kZWRGbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmIChzZWxmLmlzU2hvd2VkKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZW1vdmUnKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9zY3JvbGwubW92ZVRvKGUuY2xpZW50WCAtIHNlbGYuX3RlbXBNb3VzZVBvc1gsIGUuY2xpZW50WSAtIHNlbGYuX3RlbXBNb3VzZVBvc1kpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RlbXBNb3VzZVBvc1kgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUudHlwZSA9PT0gJ3RvdWNobW92ZScpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3Njcm9sbC5tb3ZlVG8oZS50b3VjaGVzWzBdLmNsaWVudFggLSBzZWxmLl90ZW1wTW91c2VQb3NYLCBlLnRvdWNoZXNbMF0uY2xpZW50WSAtIHNlbGYuX3RlbXBNb3VzZVBvc1kpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWCA9IGUudG91Y2hlc1swXS5jbGllbnRYO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGVtcE1vdXNlUG9zWSA9IGUudG91Y2hlc1swXS5jbGllbnRZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59OyIsIkluZmluaXR5U2Nyb2xsLk1hcCA9IGZ1bmN0aW9uIChzY3JlZW5FbG0sIGNvbmZpZ1JlZikge1xyXG4gICAgdGhpcy53aWR0aCA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuaGVpZ2h0ID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5wb3NYID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5wb3NZID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5lbG0gPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl9jb3BpZXMgPSBbXTtcclxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnUmVmO1xyXG4gICAgdGhpcy5zY3JlZW5FbG0gPSBzY3JlZW5FbG07XHJcbiAgICB0aGlzLnJlc2l6ZUZuID0gdGhpcy5yZXNpemVVbmJpbmRlZEZuKCk7XHJcblxyXG4gICAgdGhpcy51cGRhdGVTaXplcygpO1xyXG4gICAgdGhpcy5pbml0KCk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLmluaXRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemVGbik7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLnVwZGF0ZVNpemVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNpemVzID0gdGhpcy5zY3JlZW5FbG0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICB0aGlzLndpZHRoID0gc2l6ZXMud2lkdGg7XHJcbiAgICB0aGlzLmhlaWdodCA9IHNpemVzLmhlaWdodDtcclxuICAgIHRoaXMucG9zWCA9IC1zaXplcy53aWR0aDtcclxuICAgIHRoaXMucG9zWSA9IC1zaXplcy5oZWlnaHQ7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLnJlc2l6ZVVuYmluZGVkRm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdG9QeCA9IEluZmluaXR5U2Nyb2xsLk1hcC50b1B4O1xyXG4gICAgdmFyIGlzQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKCFpc0NoYW5nZWQpIHtcclxuICAgICAgICAgICAgaXNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpc0NoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlU2l6ZXMoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0U3RhdGUoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX2NvcGllc1xyXG4gICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChjb3B5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcHkuc3R5bGVbJ3dpZHRoJ10gPSB0b1B4KHNlbGYud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3B5LnN0eWxlWydoZWlnaHQnXSA9IHRvUHgoc2VsZi5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk1hcC5wcm90b3R5cGUuc2V0UG9zWCA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICBpZiAoIWlzTmFOKHgpICYmIHRoaXMuY29uZmlnLmF4aXNYKSB7XHJcbiAgICAgICAgdGhpcy5wb3NYID0gdGhpcy5wb3NYICsgeDtcclxuICAgICAgICB0aGlzLnBvc1ggPSB0aGlzLnBvc1ggPCAwID8gdGhpcy5wb3NYIDogLXRoaXMud2lkdGg7XHJcbiAgICAgICAgdGhpcy5wb3NYID0gKDAgLSB0aGlzLndpZHRoICogMiA8IHRoaXMucG9zWCkgPyB0aGlzLnBvc1ggOiAtdGhpcy53aWR0aDtcclxuICAgICAgICB0aGlzLmVsbS5zdHlsZVsnbGVmdCddID0gSW5maW5pdHlTY3JvbGwuTWFwLnRvUHgodGhpcy5wb3NYKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk1hcC5wcm90b3R5cGUuc2V0UG9zWSA9IGZ1bmN0aW9uICh5KSB7XHJcbiAgICBpZiAoIWlzTmFOKHkpICYmIHRoaXMuY29uZmlnLmF4aXNZKSB7XHJcbiAgICAgICAgdGhpcy5wb3NZID0gdGhpcy5wb3NZICsgeTtcclxuICAgICAgICB0aGlzLnBvc1kgPSB0aGlzLnBvc1kgPCAwID8gdGhpcy5wb3NZIDogLXRoaXMuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMucG9zWSA9ICgwIC0gdGhpcy5oZWlnaHQgKiAyIDwgdGhpcy5wb3NZKSA/IHRoaXMucG9zWSA6IC10aGlzLmhlaWdodDtcclxuXHJcbiAgICAgICAgdGhpcy5lbG0uc3R5bGVbJ3RvcCddID0gSW5maW5pdHlTY3JvbGwuTWFwLnRvUHgodGhpcy5wb3NZKTtcclxuICAgIH1cclxufTtcclxuXHJcbkluZmluaXR5U2Nyb2xsLk1hcC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB0b1B4ID0gSW5maW5pdHlTY3JvbGwuTWFwLnRvUHg7XHJcbiAgICB2YXIgbmVjZXNzYXJ5Q29waWVzID0gMTtcclxuICAgIGlmICh0aGlzLmNvbmZpZy5heGlzWCkge1xyXG4gICAgICAgIG5lY2Vzc2FyeUNvcGllcyAqPSAzO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuY29uZmlnLmF4aXNZKSB7XHJcbiAgICAgICAgbmVjZXNzYXJ5Q29waWVzICo9IDM7XHJcbiAgICB9XHJcbiAgICB0aGlzLmVsbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgdGhpcy5lbG0uY2xhc3NMaXN0LmFkZCgnbWFwJyk7XHJcbiAgICB0aGlzLmVsbS5zdHlsZVsndXNlci1zZWxlY3QnXSA9ICdub25lJztcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5lY2Vzc2FyeUNvcGllczsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSB0aGlzLnNjcmVlbkVsbS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgY29weS5zdHlsZVsnZmxvYXQnXSA9ICdsZWZ0JztcclxuICAgICAgICBjb3B5LnN0eWxlWyd3aWR0aCddID0gdG9QeCh0aGlzLndpZHRoKTtcclxuICAgICAgICBjb3B5LnN0eWxlWydoZWlnaHQnXSA9IHRvUHgodGhpcy5oZWlnaHQpO1xyXG4gICAgICAgIHRoaXMuZWxtLmFwcGVuZENoaWxkKGNvcHkpO1xyXG4gICAgICAgIHRoaXMuX2NvcGllcy5wdXNoKGNvcHkpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc2NyZWVuRWxtLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICB0aGlzLnNjcmVlbkVsbS5zdHlsZVsncG9zaXRpb24nXSA9ICdyZWxhdGl2ZSc7XHJcbiAgICB0aGlzLnNjcmVlbkVsbS5zdHlsZVsnb3ZlcmZsb3cnXSA9ICdoaWRkZW4nO1xyXG4gICAgdGhpcy5lbG0uc3R5bGVbJ3Bvc2l0aW9uJ10gPSAnYWJzb2x1dGUnO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgpO1xyXG4gICAgdGhpcy5pbml0TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnNjcmVlbkVsbS5hcHBlbmRDaGlsZCh0aGlzLmVsbSk7XHJcbn07XHJcblxyXG5JbmZpbml0eVNjcm9sbC5NYXAucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHRvUHggPSBJbmZpbml0eVNjcm9sbC5NYXAudG9QeDtcclxuICAgIGlmICh0aGlzLmNvbmZpZy5heGlzWSkge1xyXG4gICAgICAgIHRoaXMuZWxtLnN0eWxlWydoZWlnaHQnXSA9IHRvUHgodGhpcy5oZWlnaHQgKiAodGhpcy5jb25maWcuYXhpc1kgPyAzIDogMSkpO1xyXG4gICAgICAgIHRoaXMuZWxtLnN0eWxlWyd0b3AnXSA9IHRvUHgodGhpcy5wb3NZKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmNvbmZpZy5heGlzWCkge1xyXG4gICAgICAgIHRoaXMuZWxtLnN0eWxlWyd3aWR0aCddID0gdG9QeCh0aGlzLndpZHRoICogKHRoaXMuY29uZmlnLmF4aXNYID8gMyA6IDEpKTtcclxuICAgICAgICB0aGlzLmVsbS5zdHlsZVsnbGVmdCddID0gdG9QeCh0aGlzLnBvc1gpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuSW5maW5pdHlTY3JvbGwuTWFwLnRvUHggPSBmdW5jdGlvbiAocHgpIHtcclxuICAgIHJldHVybiBweCArICdweCc7XHJcbn07Il19
